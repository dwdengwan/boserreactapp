<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ECharts</title>
    <!-- 引入 echarts.js -->
    <script src="https://cdn.bootcss.com/echarts/4.2.1-rc1/echarts.min.js"></script>
    <style>
        html,body{
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        .chart_box{
            width: 100%;
            height: 100%;
            margin: 0 auto;
        }
    </style>
</head>
<body>
<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
<div class="chart_box">
    <div id="chinesechart"></div>
</div>
<script type="text/javascript">
    function getStyle(el, name) {
        if (window.getComputedStyle) {
            return window.getComputedStyle(el, null);
        } else {
            return el.currentStyle;
        }
    }
    //参数container为图表盒子节点.charts为图表节点
    function chartssize (container,charts) {
        function getStyle(el, name) {
            if (window.getComputedStyle) {
                return window.getComputedStyle(el, null);
            } else {
                return el.currentStyle;
            }
        }
        var wi = getStyle(container, 'width').width;
        var hi = getStyle(container, 'height').height;
        charts.style.width = wi
        charts.style.height = hi
    }

    let chartBox = document.getElementsByClassName('chart_box')[0];
    let myChartsize = document.getElementById('chinesechart');
    chartssize(chartBox,myChartsize)

    window.onresize=function(){
        let chartBox = document.getElementsByClassName('chart_box')[0];
        let myChartsize = document.getElementById('chinesechart');
        console.log(chartBox,myChartsize);
        chartssize(chartBox,myChartsize)
    }

    let echartData = [
        {
            name: '万科企业股份有限公司',
            value: 6,
            symbol:'rect',
            symbolSize: [180, 40],
            itemStyle: {
                normal: {
                    label: {
                        show: false
                    },
                    borderWidth:0,
                },
            },
            children: [
                {
                    name: '分支机构',
                    value: 6,
                    symbol:'rect',
                    symbolSize: [120, 40],
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                        },
                        borderWidth:0,
                    },
                    children: [
                        {
                            name: '万科股份有限公司北海公司',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '万科股份有限公司北海公司',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '万科股份有限公司北海公司',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '查看更多',
                            symbol:'rect',
                            symbolSize: [120, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                    ]
                },
                {
                    name: '对外投资',
                    symbol:'rect',
                    symbolSize: [120, 40],
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                        },
                        borderWidth:0,
                    },
                    value: 4,
                    children: [
                        {
                            name: '万科股份有限公司北海公司',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '万科股份有限公司北海公司',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '万科股份有限公司北海公司',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '万科股份有限公司北海公司',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '万科股份有限公司北海公司',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '万科股份有限公司北海公司',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '收起',
                            symbol:'rect',
                            symbolSize: [120, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                    ]
                },
                {
                    name: '疑似控股',
                    symbol:'rect',
                    symbolSize: [120, 40],
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                        },
                        borderWidth:0,
                    },
                    value: 2,
                    children: [
                        {
                            name: '万科股份有限公司北海公司1',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '万科股份有限公司北海公司2',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '万科股份有限公司北海公司3',
                            symbol:'rect',
                            symbolSize: [220, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                        {
                            name: '查看更多',
                            symbol:'rect',
                            symbolSize: [120, 40],
                            value: 4,
                            itemStyle: {
                                normal: {
                                    label: {
                                        show: false
                                    },
                                },
                                borderWidth:0,
                            },
                        },
                    ]
                },
            ]
        }
    ]
    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('chinesechart'));
    myChart.setOption(option = {
        // tooltip: {
        //     // show：'true',//默认：true；是否显示提示框组件，包括提示框浮层和 axisPointer。
        //     trigger: 'item',//默认：item；触发类型。item：数据项图形触发，主要在散点图，饼图等无类目轴的图表中使用。'axis'：坐标轴触发，主要在柱状图，折线图等会使用类目轴的图表中使用。'none':什么都不触发。
        //     triggerOn: 'mousemove'
        // },
        tooltip:{
            trigger:'axis',
            triggerOn: 'mousemove',
            axisPointer:{
                type:'shadow',
            },
            //下面是自定义悬浮框的部分，修改悬浮框的样式也是在这里，就是html的样式，自由发挥。
            formatter:function(params){
                var res="<p>名称:"+params[0].seriesName+"值:"+params[0].data.value+"时间:"+params[0].data.mDate+"</p>";
                console.log(res,params);
                return res;
            }
        },
        series : [
            {
                top:0,
                left:'50%',
                right:'10%',
                bottom:0,
                name:'树图',
                type:'tree',
                // orient: 'horizontal',  // vertical horizontal
                layout:'orthogonal',
                orient: 'LR' ,
                rootLocation: {x: '50%', y: '50%'}, // 根节点位置  {x: 'center',y: 10}
                nodePadding: 20,
                symbol: 'circle',
                symbolSize: 40,
                edgeShape: 'polyline',
                leaves:{

                },
                data: echartData,
                expandAndCollapse: true,
                animationDuration: 550,
                animationDurationUpdate: 750,
            },
            {
                top:0,
                left:'10%',
                right:'50%',
                bottom:0,
                name:'树图',
                type:'tree',
                // orient: 'vertical',  // vertical horizontal
                layout:'orthogonal',
                orient: 'RL',
                rootLocation: {x: '50%', y: '50%'}, // 根节点位置  {x: 'center',y: 10}
                nodePadding: 20,
                symbol: 'circle',
                symbolSize: 40,
                edgeShape: 'polyline',
                itemStyle: {
                    normal: {
                        label: {
                            show: true,
                            position: 'inside',
                            textStyle: {
                                color: '#cc9999',
                                fontSize: 15,
                                fontWeight:  'bolder'
                            }
                        },
                        lineStyle: {
                            color: '#000',
                            width: 1,
                            type: 'solid' // 'curve'|'broken'|'solid'|'dotted'|'dashed'
                        }
                    },
                    emphasis: {
                        label: {
                            show: true
                        }
                    }
                },
                data: echartData,
                expandAndCollapse: true,
                animationDuration: 550,
                animationDurationUpdate: 750
            },
        ]
    });
    myChart.on('click', clickFun); //也可以注册其他时间 hover 、mouseout等
    function clickFun(params) {
        console.log(params.dataIndex,params)
        if(params.dataIndex == 16){
            console.log('dyk kyd');
            let child = echartData[2].children;
            child.splice(child.length - 1,1);
            let addData = [
                {
                    name: '万科股份有限公司北海公司4',
                    symbol:'rect',
                    symbolSize: [220, 40],
                    value: 4,
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                        },
                        borderWidth:0,
                    },
                },
                {
                    name: '万科股份有限公司北海公司5',
                    symbol:'rect',
                    symbolSize: [220, 40],
                    value: 4,
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                        },
                        borderWidth:0,
                    },
                },
                {
                    name: '万科股份有限公司北海公司6',
                    symbol:'rect',
                    symbolSize: [220, 40],
                    value: 4,
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                        },
                        borderWidth:0,
                    },
                },
                {
                    name: '收起',
                    symbol:'rect',
                    symbolSize: [120, 40],
                    value: 4,
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                        },
                        borderWidth:0,
                    },
                }
                ];
            child.concat(addData);
        }
    }
    //计算树下有多少子节点
    let num = 0;
    function countChild(arr) {
        arr.forEach((item,i)=>{
            if (item.children !== undefined){
                num += item.children.length;
                countChild(item.children)
            }
        })
        console.log(num);
    }
    countChild(echartData);
</script>
</body>
</html>